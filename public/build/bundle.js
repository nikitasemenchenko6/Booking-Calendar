var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode.removeChild(t)}function a(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function p(t,e,n){t.classList[n?"add":"remove"](e)}let $;function v(t){$=t}function y(){if(!$)throw new Error("Function called outside component initialization");return $}function b(){const t=y();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const r=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach((e=>{e.call(t,r)}))}}}const w=[],k=[],x=[],A=[],D=Promise.resolve();let j=!1;function _(t){x.push(t)}let E=!1;const M=new Set;function C(){if(!E){E=!0;do{for(let t=0;t<w.length;t+=1){const e=w[t];v(e),S(e.$$)}for(v(null),w.length=0;k.length;)k.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];M.has(e)||(M.add(e),e())}x.length=0}while(w.length);for(;A.length;)A.pop()();j=!1,E=!1,M.clear()}}function S(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const T=new Set;let q;function F(){q={r:0,c:[],p:q}}function N(){q.r||o(q.c),q=q.p}function O(t,e){t&&t.i&&(T.delete(t),t.i(e))}function J(t,e,n,o){if(t&&t.o){if(T.has(t))return;T.add(t),q.c.push((()=>{T.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function L(t,e){const n=e.token={};function o(t,o,r,l){if(e.token!==n)return;e.resolved=l;let c=e.ctx;void 0!==r&&(c=c.slice(),c[r]=l);const s=t&&(e.current=t)(c);let i=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(F(),J(t,1,1,(()=>{e.blocks[n]=null})),N())})):e.block.d(1),s.c(),O(s,1),s.m(e.mount(),e.anchor),i=!0),e.block=s,e.blocks&&(e.blocks[o]=s),i&&C()}if((r=t)&&"object"==typeof r&&"function"==typeof r.then){const n=y();if(t.then((t=>{v(n),o(e.then,1,e.value,t),v(null)}),(t=>{if(v(n),o(e.catch,2,e.error,t),v(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}var r}function P(t,e){t.d(1),e.delete(t.key)}function Y(t){t&&t.c()}function z(t,n,l){const{fragment:c,on_mount:s,on_destroy:i,after_update:a}=t.$$;c&&c.m(n,l),_((()=>{const n=s.map(e).filter(r);i?i.push(...n):o(n),t.$$.on_mount=[]})),a.forEach(_)}function B(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(w.push(t),j||(j=!0,D.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function G(e,r,l,c,s,a,u=[-1]){const f=$;v(e);const d=r.props||{},h=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:u,skip_bound:!1};let g=!1;if(h.ctx=l?l(e,d,((t,n,...o)=>{const r=o.length?o[0]:n;return h.ctx&&s(h.ctx[t],h.ctx[t]=r)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](r),g&&W(e,t)),n})):[],h.update(),g=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);h.fragment&&h.fragment.l(t),t.forEach(i)}else h.fragment&&h.fragment.c();r.intro&&O(e.$$.fragment),z(e,r.target,r.anchor),C()}v(f)}class H{$destroy(){B(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const I=["January","February","March","April","May","June","July","August","September","October","November","December"],K=[31,28,31,30,31,30,31,31,30,31,30,31],Q=(t,e)=>1!==t?K[t]:(t=>t%4==0)(e)?29:28,R=t=>I[t],U=(t,e)=>{const{days:n}=((t,e)=>{const n=new Date(e,t,1).getMonth();return{name:n[n],days:Q(n,e)}})(t,e),o=Array.from({length:42}).map((()=>[])),r=new Date(e,t,1).getDay();Array.from({length:n}).forEach(((t,e)=>{o[r+e]=e+1}));const l=o.map((t=>Array.isArray(t)?void 0:t));return l[35]?l:l.slice(0,-7)},V=()=>{},X=(()=>{let t=1;return()=>++t})();function Z(t,e,n){const o=t.slice();return o[9]=e[n].allowed,o[10]=e[n].value,o}function tt(t,e,n){const o=t.slice();return o[13]=e[n],o}function et(e){let n,o,r=e[13]+"";return{c(){n=u("div"),o=f(r),g(n,"class","cell svelte-1xnygc9")},m(t,e){s(t,n,e),c(n,o)},p:t,d(t){t&&i(n)}}}function nt(t,e){let n,o,l,a,$,v=(e[10]||"")+"";return{key:t,first:null,c(){n=u("div"),o=f(v),l=d(),g(n,"class","svelte-1xnygc9"),p(n,"cell",!0),p(n,"highlight",e[9]&&e[10]),p(n,"disabled",!e[9]),p(n,"selected",new Date(e[0].getFullYear(),e[0].getMonth(),e[0].getDate()).getTime()===new Date(e[2],e[1],e[10]).getTime()),this.first=n},m(t,i){s(t,n,i),c(n,o),c(n,l),a||($=h(n,"click",(function(){r(e[9]&&e[10]?e[5].bind(this,e[10]):V)&&(e[9]&&e[10]?e[5].bind(this,e[10]):V).apply(this,arguments)})),a=!0)},p(t,r){e=t,8&r&&v!==(v=(e[10]||"")+"")&&m(o,v),8&r&&p(n,"highlight",e[9]&&e[10]),8&r&&p(n,"disabled",!e[9]),15&r&&p(n,"selected",new Date(e[0].getFullYear(),e[0].getMonth(),e[0].getDate()).getTime()===new Date(e[2],e[1],e[10]).getTime())},d(t){t&&i(n),a=!1,$()}}}function ot(e){let n,o,r,l,f=[],h=new Map,m=e[4],p=[];for(let t=0;t<m.length;t+=1)p[t]=et(tt(e,m,t));let $=e[3];const v=t=>X();for(let t=0;t<$.length;t+=1){let n=Z(e,$,t),o=v();h.set(o,f[t]=nt(o,n))}return{c(){n=u("div"),o=u("div");for(let t=0;t<p.length;t+=1)p[t].c();r=d(),l=u("div");for(let t=0;t<f.length;t+=1)f[t].c();g(o,"class","row svelte-1xnygc9"),g(l,"class","row svelte-1xnygc9"),g(n,"class","container svelte-1xnygc9")},m(t,e){s(t,n,e),c(n,o);for(let t=0;t<p.length;t+=1)p[t].m(o,null);c(n,r),c(n,l);for(let t=0;t<f.length;t+=1)f[t].m(l,null)},p(t,[e]){if(16&e){let n;for(m=t[4],n=0;n<m.length;n+=1){const r=tt(t,m,n);p[n]?p[n].p(r,e):(p[n]=et(r),p[n].c(),p[n].m(o,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=m.length}if(47&e){const n=t[3];f=function(t,e,n,o,r,l,c,s,i,a,u,f){let d=t.length,h=l.length,g=d;const m={};for(;g--;)m[t[g].key]=g;const p=[],$=new Map,v=new Map;for(g=h;g--;){const t=f(r,l,g),s=n(t);let i=c.get(s);i?o&&i.p(t,e):(i=a(s,t),i.c()),$.set(s,p[g]=i),s in m&&v.set(s,Math.abs(g-m[s]))}const y=new Set,b=new Set;function w(t){O(t,1),t.m(s,u),c.set(t.key,t),u=t.first,h--}for(;d&&h;){const e=p[h-1],n=t[d-1],o=e.key,r=n.key;e===n?(u=e.first,d--,h--):$.has(r)?!c.has(o)||y.has(o)?w(e):b.has(r)?d--:v.get(o)>v.get(r)?(b.add(o),w(e)):(y.add(r),d--):(i(n,c),d--)}for(;d--;){const e=t[d];$.has(e.key)||i(e,c)}for(;h;)w(p[h-1]);return p}(f,e,v,1,t,n,h,l,P,nt,null,Z)}},i:t,o:t,d(t){t&&i(n),a(p,t);for(let t=0;t<f.length;t+=1)f[t].d()}}}function rt(t,e,n){const o=b();let{date:r}=e,{month:l}=e,{year:c}=e,{isAllowed:s}=e;let i;const a=(t,e,n)=>!n||s(new Date(t,e,n));return t.$$set=t=>{"date"in t&&n(0,r=t.date),"month"in t&&n(1,l=t.month),"year"in t&&n(2,c=t.year),"isAllowed"in t&&n(6,s=t.isAllowed)},t.$$.update=()=>{6&t.$$.dirty&&n(3,i=U(l,c).map((t=>({value:t,allowed:a(c,l,t)}))))},[r,l,c,i,["Su","Mo","Tu","We","Th","Fr","Sa"],t=>{o("datechange",new Date(c,l,t))},s]}class lt extends H{constructor(t){super(),G(this,t,rt,ot,l,{date:0,month:1,year:2,isAllowed:6})}}function ct(t){let e,n,r,l,a,p,$,v,y,b,w,k,x,A,D,j,_,E=R(t[2])+"";return A=new lt({props:{month:t[2],year:t[3],date:t[1],isAllowed:t[0]}}),A.$on("datechange",t[8]),{c(){e=u("div"),n=u("div"),r=u("div"),l=u("button"),l.textContent="Prev",a=d(),p=u("div"),$=f(E),v=d(),y=f(t[3]),b=d(),w=u("div"),k=u("button"),k.textContent="Next",x=d(),Y(A.$$.fragment),g(r,"class","center svelte-1u7qjjs"),g(p,"class","center svelte-1u7qjjs"),g(w,"class","center svelte-1u7qjjs"),g(n,"class","month-name svelte-1u7qjjs"),g(e,"class","box svelte-1u7qjjs")},m(o,i){s(o,e,i),c(e,n),c(n,r),c(r,l),c(n,a),c(n,p),c(p,$),c(p,v),c(p,y),c(n,b),c(n,w),c(w,k),c(e,x),z(A,e,null),D=!0,j||(_=[h(l,"click",t[7]),h(k,"click",t[6])],j=!0)},p(t,e){(!D||4&e)&&E!==(E=R(t[2])+"")&&m($,E),(!D||8&e)&&m(y,t[3]);const n={};4&e&&(n.month=t[2]),8&e&&(n.year=t[3]),2&e&&(n.date=t[1]),1&e&&(n.isAllowed=t[0]),A.$set(n)},i(t){D||(O(A.$$.fragment,t),D=!0)},o(t){J(A.$$.fragment,t),D=!1},d(t){t&&i(e),B(A),j=!1,o(_)}}}function st(t){let e,n,o,r,l,a,f,m=t[4]&&ct(t);return{c(){e=u("div"),n=u("input"),r=d(),m&&m.c(),g(n,"type","text"),n.value=o=t[1].toDateString(),g(e,"class","relative svelte-1u7qjjs")},m(o,i){s(o,e,i),c(e,n),c(e,r),m&&m.m(e,null),l=!0,a||(f=h(n,"focus",t[5]),a=!0)},p(t,[r]){(!l||2&r&&o!==(o=t[1].toDateString())&&n.value!==o)&&(n.value=o),t[4]?m?(m.p(t,r),16&r&&O(m,1)):(m=ct(t),m.c(),O(m,1),m.m(e,null)):m&&(F(),J(m,1,1,(()=>{m=null})),N())},i(t){l||(O(m),l=!0)},o(t){J(m),l=!1},d(t){t&&i(e),m&&m.d(),a=!1,f()}}}function it(t,e,n){const o=b();let r,l,c,s,{isAllowed:i=(()=>!0)}=e,{selected:a=new Date}=e;return t.$$set=t=>{"isAllowed"in t&&n(0,i=t.isAllowed),"selected"in t&&n(1,a=t.selected)},t.$$.update=()=>{2&t.$$.dirty&&(r=a.getDate(),n(2,l=a.getMonth()),n(3,c=a.getFullYear()))},[i,a,l,c,s,()=>{n(4,s=!0)},()=>{if(11===l)return n(2,l=0),void n(3,c+=1);n(2,l+=1)},()=>{if(0===l)return n(2,l=11),void n(3,c-=1);n(2,l-=1)},t=>{n(4,s=!1),o("datechange",t.detail)}]}class at extends H{constructor(t){super(),G(this,t,it,st,l,{isAllowed:0,selected:1})}}function ut(t,e,n){const o=t.slice();return o[5]=e[n],o}function ft(t){let e,n,o=t[8].message+"";return{c(){var t,r,l;e=u("p"),n=f(o),t="color",r="red",e.style.setProperty(t,r,l?"important":"")},m(t,o){s(t,e,o),c(e,n)},p(t,e){2&e&&o!==(o=t[8].message+"")&&m(n,o)},d(t){t&&i(e)}}}function dt(t){let e,n=t[1],o=[];for(let e=0;e<n.length;e+=1)o[e]=ht(ut(t,n,e));return{c(){e=u("div");for(let t=0;t<o.length;t+=1)o[t].c();g(e,"class","times")},m(t,n){s(t,e,n);for(let t=0;t<o.length;t+=1)o[t].m(e,null)},p(t,r){if(2&r){let l;for(n=t[1],l=0;l<n.length;l+=1){const c=ut(t,n,l);o[l]?o[l].p(c,r):(o[l]=ht(c),o[l].c(),o[l].m(e,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=n.length}},d(t){t&&i(e),a(o,t)}}}function ht(t){let e,n,o,r=t[5][0]+"";return{c(){e=u("button"),n=f(r),g(e,"name","time"),e.value=o=t[5][1]},m(t,o){s(t,e,o),c(e,n)},p(t,l){2&l&&r!==(r=t[5][0]+"")&&m(n,r),2&l&&o!==(o=t[5][1])&&(e.value=o)},d(t){t&&i(e)}}}function gt(e){let n;return{c(){n=u("p"),n.textContent="Aikoja ladataan"},m(t,e){s(t,n,e)},p:t,d(t){t&&i(n)}}}function mt(t){let e,n,o,r,l;e=new at({props:{selected:t[0],isAllowed:t[3]}}),e.$on("datechange",t[2]);let c={ctx:t,current:null,token:null,hasCatch:!0,pending:gt,then:dt,catch:ft,value:4,error:8};return L(r=t[1],c),{c(){Y(e.$$.fragment),n=d(),o=f(""),c.block.c()},m(t,r){z(e,t,r),s(t,n,r),s(t,o,r),c.block.m(t,c.anchor=r),c.mount=()=>o.parentNode,c.anchor=o,l=!0},p(n,[o]){t=n;const l={};if(1&o&&(l.selected=t[0]),e.$set(l),c.ctx=t,2&o&&r!==(r=t[1])&&L(r,c));else{const e=t.slice();e[4]=e[8]=c.resolved,c.block.p(e,o)}},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){J(e.$$.fragment,t),l=!1},d(t){B(e,t),t&&i(n),t&&i(o),c.block.d(t),c.token=null,c=null}}}async function pt(t){const e=await self.fetch("/api?day="+t.valueOf());if(e.ok)return e.json();throw new Error(e)}function $t(t,e,n){let o=new Date((new Date).valueOf()+864e5);let r;return t.$$.update=()=>{1&t.$$.dirty&&n(1,r=pt(o))},[o,r,t=>{n(0,o=t.detail),n(1,r=pt(o))},t=>{const e=t.getTime();return!(e+9e7<Date.now())&&!(e>Date.now()+3888e6)}]}return new class extends H{constructor(t){super(),G(this,t,$t,mt,l,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
